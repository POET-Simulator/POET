/*
** Copyright (C) 2018-2021 Alexander Lindemann, Max Luebke (University of
** Potsdam)
**
** Copyright (C) 2018-2023 Marco De Lucia, Max Luebke (GFZ Potsdam)
**
** Copyright (C) 2023-2024 Max Luebke (University of Potsdam)
**
** POET is free software; you can redistribute it and/or modify it under the
** terms of the GNU General Public License as published by the Free Software
** Foundation; either version 2 of the License, or (at your option) any later
** version.
**
** POET is distributed in the hope that it will be useful, but WITHOUT ANY
** WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
** A PARTICULAR PURPOSE. See the GNU General Public License for more details.
**
** You should have received a copy of the GNU General Public License along with
** this program; if not, write to the Free Software Foundation, Inc., 51
** Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
*/

#pragma once

#include <cstdint>
#include <set>
#include <string>
#include <vector>

#include <Rcpp.h>

#define SRC_DIR "@CMAKE_SOURCE_DIR@"
#define CUDA_SRC_DIR "@CUDA_TOOLKIT_ROOT_DIR@"
#define USE_NAA "@USE_NAA@"

// target and source IP address for NAA support
// #ifdef USE_NAA
#define SOURCE_IP "@SOURCE_IP@"
#define TARGET_IP "@TARGET_IP@"
// #endif

static const char *poet_version = "@POET_VERSION@";

// using the Raw string literal to avoid escaping the quotes
static const inline std::string kin_r_library = R"(@R_KIN_LIB@)";
static const inline std::string init_r_library = R"(@R_INIT_LIB@)";
static const inline std::string ai_surrogate_r_library =
    R"(@R_AI_SURROGATE_LIB@)";
static const inline std::string r_runtime_parameters = "mysetup";

struct RuntimeParameters {
  std::string out_dir;
  std::vector<double> timesteps;

  Rcpp::List init_params;

  bool as_rds = false;
  std::string out_ext; // MDL added to accomodate for qs::qsave/qread

  bool print_progress = false;

  static constexpr std::uint32_t WORK_PACKAGE_SIZE_DEFAULT = 32;
  std::uint32_t work_package_size;

  bool use_dht = false;
  static constexpr std::uint32_t DHT_SIZE_DEFAULT = 1.5E3;
  std::uint32_t dht_size;
  static constexpr std::uint8_t DHT_SNAPS_DEFAULT = 0;
  std::uint8_t dht_snaps;

  bool use_interp = false;
  static constexpr std::uint32_t INTERP_SIZE_DEFAULT = 100;
  std::uint32_t interp_size;
  static constexpr std::uint32_t INTERP_MIN_ENTRIES_DEFAULT = 5;
  std::uint32_t interp_min_entries;
  static constexpr std::uint32_t INTERP_BUCKET_ENTRIES_DEFAULT = 20;
  std::uint32_t interp_bucket_entries;

  /*AI surriogate configuration*/
  bool use_ai_surrogate = false; // Can be set with command line flag ---ai-surrogate
  bool disable_training = false; // Can be set in the R input script
  bool use_clustering = false; // Can be set in the R input script
  bool use_Keras_predictions = false; // Can be set in the R input script
  bool train_only_invalid = false; // Can be set in the R input script
  int batch_size = 2560; // default value determined in test on the UP Turing cluster
  int training_epochs = 20;; // Can be set in the R input script
  int training_data_size; // Can be set in the R input script
  bool use_naa = false;
  std::string save_model_path = ""; // Can be set in the R input script
  std::string cuda_src_dir = CUDA_SRC_DIR; // From CMake
};
